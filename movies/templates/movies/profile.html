{% extends 'movies/base.html' %}

{% block title_block %}My Profile{% endblock %}

{% block body_block %}
    <h1>Welcome, {{ profile_user.username }}</h1>
    <p>Email: {{ profile_user.email }}</p>
    <p>Joined on: {{ profile_user.date_joined|date:"F j, Y" }}</p>

    <hr>

    <h2>Favorite Movies</h2>
    {% if favorites %}
        <div style="display: flex; flex-wrap: wrap; gap: 20px;">
            {% for fav in favorites %}
                <div>
                    <a href="{% url 'movies:movie_detail' fav.movie.id %}">
                        {% if fav.movie.poster %}
                            <img src="{{ fav.movie.poster.url }}" alt="{{ fav.movie.title }} poster" width="120">
                        {% else %}
                            <div style="width:120px; height:180px; background:#ccc; display:flex; align-items:center; justify-content:center;">
                                No Image
                            </div>
                        {% endif %}
                    </a>
                    <p>{{ fav.movie.title }}</p>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No favorites yet.</p>
    {% endif %}

    <hr>

    <h2>My Reviews</h2>
    {% if profile_user.review_set.all %}
        <ul>
            {% for review in profile_user.review_set.all %}
                <li>
                    <strong>{{ review.movie.title }}</strong>
                    <span>
                        {% for i in "12345" %}
                            {% if forloop.counter <= review.rating %}⭐{% else %}☆{% endif %}
                        {% endfor %}
                    </span>
                    <br>
                    {{ review.text }}
                    <br>
                    <small>{{ review.created_at }}</small>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>No reviews yet.</p>
    {% endif %}
{% endblock %}
